import*as e from"https://cdn.jsdelivr.net/npm/three@0.117.1/build/three.module.js";import{OrbitControls as t}from"https://cdn.jsdelivr.net/npm/three@0.124/examples/jsm/controls/OrbitControls.js";let n=document.getElementById("sphererenderer"),r=new e.Scene,o=new e.PerspectiveCamera(75,1,.1,1e3),i=new e.WebGLRenderer({canvas:n,antialias:!0});i.setSize(250,250),i.setPixelRatio(2),i.setClearColor(16777195);let s=new t(o,i.domElement),a=new e.SphereGeometry(8,16,16),l=new e.WireframeGeometry(a),d=new e.LineBasicMaterial({color:0,transparent:!0,opacity:.5}),c=new e.LineSegments(l,d);r.add(c);let p=new e.BufferGeometry,u=new e.PointsMaterial({size:1,vertexColors:!0}),w=new e.Points(p,u);async function m(t){let n=new Float32Array(t),r=[],o=[];for(let e=0;e<n.length;e+=3){let t=!1;for(let i=0;i<o.length;i+=1){let s=n[e]-r[3*i],a=n[e+1]-r[3*i+1],l=n[e+2]-r[3*i+2];.05>Math.sqrt(s*s+a*a+l*l)&&(o[i]+=1,t=!0)}t||(r.push(n[e],n[e+1],n[e+2]),o.push(0))}let i=[];for(let t=0;t<o.length;t++){let r=n.length/3-1,s=new e.Color().setHSL((1-o[t]/r)*.7,.8,.5);console.log((1-o[t]/r)*.7),i.push(s.r,s.g,s.b)}console.log(o),p.setAttribute("position",new e.BufferAttribute(new Float32Array(r),3)),p.setAttribute("color",new e.Float32BufferAttribute(i,3)),p.attributes.position.needsUpdate=!0,p.attributes.color.needsUpdate=!0}function h(t,n){let o=new e.LineCurve3(new e.Vector3(0,0,0),t),i=new e.TubeGeometry(o,4,.2,8,!1),s=new e.MeshBasicMaterial({color:n,transparent:!0,opacity:.5}),a=new e.Mesh(i,s);r.add(a)}r.add(w),document.addEventListener("blochpointsupdate",function(e){m(e.detail)}),m([0,8,0,0,8,0]),h(new e.Vector3(8,0,0),16711680),h(new e.Vector3(0,8,0),65280),h(new e.Vector3(0,0,8),255),o.position.x=7.1,o.position.y=10.6,o.position.z=7.1,s.update(),function e(){requestAnimationFrame(e),s.update(),i.render(r,o)}();